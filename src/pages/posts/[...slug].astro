---
import { getCollection, render } from "astro:content";
import BlogPost from "../../layouts/BlogPost.astro";
import NotFound from "../404.astro";

const { slug } = Astro.params;
const posts = await getCollection("blog");
const post = posts.find((p) => p.id === slug);

let Content: Awaited<ReturnType<typeof render>>["Content"] | null = null;
if (post) {
    Content = (await render(post)).Content;
} else {
    Astro.response.status = 404;
}
---

{post && Content ? (
    <BlogPost {...post.data}>
        <Content />
    </BlogPost>
) : (
    <NotFound />
)}
