---
import { getCollection, render } from "astro:content";
import PoetryPost from "../../layouts/PoetryPost.astro";
import NotFound from "../404.astro";

const { slug } = Astro.params;
const poems = await getCollection("poetry");
const post = poems.find((p) => p.id === slug);

let Content: Awaited<ReturnType<typeof render>>["Content"] | null = null;
if (post) {
    Content = (await render(post)).Content;
} else {
    Astro.response.status = 404;
}
---

{post && Content ? (
    <PoetryPost {...post.data}>
        <Content />
    </PoetryPost>
) : (
    <NotFound />
)}
