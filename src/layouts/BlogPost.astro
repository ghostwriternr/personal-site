---
import type { CollectionEntry } from "astro:content";
import BaseLayout from "./BaseLayout.astro";
import FormattedDate from "../components/FormattedDate.astro";

type Props = CollectionEntry<"blog">["data"] & {
    prevPost?: CollectionEntry<"blog"> | null;
    nextPost?: CollectionEntry<"blog"> | null;
};

const { title, description, pubDate, updatedDate, prevPost, nextPost } = Astro.props;
---

<BaseLayout title={title} description={description}>
    <main
        class="col-span-12 pt-4 md:col-span-10 md:col-start-2 xl:col-span-8 xl:col-start-3"
    >
        <div class="article-text mx-auto w-full max-w-4xl">
            <div class="content-header mb-8 py-4">
                <h1
                    class="content-title animate-content-title text-display-sm text-primary m-0 mb-1"
                >
                    {title}
                </h1>
                <div
                    class="content-meta animate-content-meta text-body-md text-subtle font-bold"
                >
                    <FormattedDate date={pubDate} />
                    {
                        updatedDate && (
                            <div class="text-body-sm mt-1 italic">
                                Last updated on{" "}
                                <FormattedDate date={updatedDate} />
                            </div>
                        )
                    }
                </div>
            </div>
            <article class="content-body animate-content-body prose article-prose">
                <slot />
            </article>

            {(prevPost || nextPost) && (
                <nav class="post-nav mt-12 flex justify-between gap-6 border-t border-[var(--color-tertiary)] pt-8">
                    {prevPost && (
                        <a href={`/posts/${prevPost.id}/`} class="prev block text-subtle hover:text-secondary">
                            <span class="text-caption-md block">Previous</span>
                            <span class="text-body-md">{prevPost.data.title}</span>
                        </a>
                    )}
                    {nextPost && (
                        <a href={`/posts/${nextPost.id}/`} class="next ml-auto block text-right text-subtle hover:text-secondary">
                            <span class="text-caption-md block">Next</span>
                            <span class="text-body-md">{nextPost.data.title}</span>
                        </a>
                    )}
                </nav>
            )}
        </div>
    </main>
</BaseLayout>

<style>
    /* Enhanced image appearance */
    .content-body :global(img) {
        animation: content-fade-in 0.45s cubic-bezier(0.22, 1, 0.36, 1) both;
    }
</style>
