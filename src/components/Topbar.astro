---
import { Image } from "astro:assets";
import MeImage from "../assets/me.png";
---

<!-- Topbar Container -->
<div class="bg-background fixed top-0 left-0 z-50 flex w-full flex-col p-4">
    <!-- Topbar Row -->
    <div class="flex items-center justify-between">
        <!-- Avatar -->
        <a href="/" class="flex items-center">
            <Image
                src={MeImage}
                alt="Avatar"
                class="h-10 w-10 cursor-pointer"
            />
        </a>
        <!-- Hamburger Button -->
        <button
            id="menu-btn"
            aria-label="Open menu"
            class="group relative flex h-8 w-8 flex-col items-center justify-center"
        >
            <span
                class="block h-1 w-8 origin-center rounded bg-orange-500 transition-all duration-300 ease-in-out"
                id="bar1"></span>
            <span
                class="mt-1.5 block h-1 w-8 origin-center rounded bg-orange-500 transition-all duration-300 ease-in-out"
                id="bar2"></span>
            <span
                class="mt-1.5 block h-1 w-8 origin-center rounded bg-orange-500 transition-all duration-300 ease-in-out"
                id="bar3"></span>
        </button>
    </div>
    <!-- Mobile Menu -->
    <div
        class="bg-background divide-tertiary pointer-events-none fixed inset-0 top-16 flex scale-95 flex-col divide-y-2 text-heading-xl opacity-0 transition-all duration-300 ease-in-out md:hidden"
    >
        <a
            href="/"
            class="flex flex-1 items-center justify-center"
            data-menu-link>Blog</a
        >
        <a
            href="/poetry"
            class="flex flex-1 items-center justify-center"
            data-menu-link>Poetry</a
        >
        <a
            href="/about"
            class="flex flex-1 items-center justify-center"
            data-menu-link>About</a
        >
    </div>
</div>

<script>
    // Hamburger menu state
    let isOpen = false;
    const btn = document.getElementById("menu-btn");
    const menu = document.getElementById("mobile-menu");
    const bar1 = document.getElementById("bar1");
    const bar2 = document.getElementById("bar2");
    const bar3 = document.getElementById("bar3");

    function toggleMenu() {
        isOpen = !isOpen;
        if (menu && bar1 && bar2 && bar3) {
            if (isOpen) {
                menu.classList.remove(
                    "opacity-0",
                    "pointer-events-none",
                    "scale-95"
                );
                menu.classList.add(
                    "opacity-100",
                    "pointer-events-auto",
                    "scale-100"
                );
                // Animate hamburger to X
                bar1.classList.add("rotate-45", "translate-y-2");
                bar2.classList.add("opacity-0");
                bar3.classList.add("-rotate-45", "-translate-y-2");
            } else {
                menu.classList.remove(
                    "opacity-100",
                    "pointer-events-auto",
                    "scale-100"
                );
                menu.classList.add(
                    "opacity-0",
                    "pointer-events-none",
                    "scale-95"
                );
                // Animate X to hamburger
                bar1.classList.remove("rotate-45", "translate-y-2");
                bar2.classList.remove("opacity-0");
                bar3.classList.remove("-rotate-45", "-translate-y-2");
            }
        }
    }

    if (btn) {
        btn.addEventListener("click", toggleMenu);
    }

    // Close menu on link click
    document.querySelectorAll("[data-menu-link]").forEach((link) => {
        link.addEventListener("click", () => {
            if (isOpen) toggleMenu();
        });
    });
</script>
